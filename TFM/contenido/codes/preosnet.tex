\begin{lstlisting}[language=Python, float=t, label=coud:preosnet, caption=Preprocesado de OSNet integrado en su estructura, basicstyle=\footnotesize]
pixel_mean = [0.485, 0.456, 0.406]
pixel_std = [0.229, 0.224, 0.225]
mean = torch.tensor(pixel_mean).view(1, 3, 1, 1)
std = torch.tensor(pixel_std).view(1, 3, 1, 1)

def forward(self, x, return_featuremaps=False):
    x = x.permute(2, 0, 1) # Swap dimension order
    x = x.unsqueeze(0) # Expand dims
    x = x[:,[2, 1, 0], :, :]  # BGR to RGB
    x = x / 255.0 # Normalization
    x = (x - mean) / std # Normalization
    x = self.featuremaps(x)
    ...

\end{lstlisting}